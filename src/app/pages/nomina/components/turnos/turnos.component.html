<div class="mx-auto">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <!-- Header -->
  <div
    class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 p-8 rounded-2xl bg-gradient-to-r from-primary/20 to-primary/10 shadow-md border border-primary/30">
    <div class="flex items-center gap-4">
      <div class="bg-white dark:bg-gray-800 rounded-full p-5 shadow-lg flex items-center justify-center -mt-4">
        <i class="pi pi-clock text-primary text-3xl"></i>
      </div>
      <div class="flex flex-col">
        <h2 class="text-3xl font-extrabold text-primary dark:text-primary-300 tracking-tight">
          Turnos
        </h2>
        <span class="text-sm text-gray-600 dark:text-gray-400">
          Administre los turnos de los empleados.
        </span>
      </div>
    </div>

    <button pButton label="Agregar Turno" icon="pi pi-plus" class="p-button-rounded p-button-success"
      (click)="agregarFila()"></button>
  </div>

  <hr class="my-4 border-primary/30 dark:border-primary/50 rounded" />

  <!-- Tabla -->
  <p-table #dt [value]="turnos" dataKey="id" editMode="row" [editingRowKeys]="editingRowKeys"
    [paginator]="true" [rows]="5" responsiveLayout="scroll"
    class="rounded-2xl shadow-md overflow-hidden border border-gray-200 dark:border-gray-700">

    <ng-template pTemplate="header">
      <tr class="bg-gradient-to-r from-primary/10 to-primary/5 text-primary-800 dark:from-primary/20 dark:to-primary/10 dark:text-primary-200">
        <th>Usuario</th>
        <th>DÃ­a Semana</th>
        <th>Entrada</th>
        <th>Salida</th>
        <th>Comida Inicio</th>
        <th>Comida Fin</th>
        <th>Observaciones</th>
        <th class="text-center">Acciones</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-turno let-editing="editing" let-ri="rowIndex">
      <tr [pEditableRow]="turno" class="hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors">

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
                  <!--Select de lstUsuarios
              <input pInputText [(ngModel)]="turno.chr_clave_usuario"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" /> -->
                <p-select [options]="lstUsuarios" optionLabel="label" optionValue="value" [(ngModel)]="turno.chr_clave_usuario" [appendTo]="'body'"
                  class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2"></p-select>
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.chr_clave_usuario }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
                <!--Select de lstDiasSemana
              <input pInputText [(ngModel)]="turno.dia_semana"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />-->
                <p-select [options]="lstDiasSemana" optionLabel="label" optionValue="value" [(ngModel)]="turno.dia_semana" [appendTo]="'body'"
                  class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2"></p-select>
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.dia_semana }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input type="time" pInputText [(ngModel)]="turno.entrada"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.entrada }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input type="time" pInputText [(ngModel)]="turno.salida"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.salida }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input type="time" pInputText [(ngModel)]="turno.comida_inicio"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.comida_inicio }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input type="time" pInputText [(ngModel)]="turno.comida_fin"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.comida_fin }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td>
          <p-cellEditor>
            <ng-template pTemplate="input">
              <input pInputText [(ngModel)]="turno.observaciones"
                class="w-full rounded-lg border border-gray-300 dark:border-gray-600 p-2" />
            </ng-template>
            <ng-template pTemplate="output">
              {{ turno.observaciones }}
            </ng-template>
          </p-cellEditor>
        </td>

        <td class="text-center flex gap-2 justify-center">
          <p-button *ngIf="!editing" icon="pi pi-pencil" [text]="true" [raised]="true" severity="info"
            title="Editar" (click)="editarFila(turno)"></p-button>
          <p-button *ngIf="editing" icon="pi pi-check" [text]="true" [raised]="true" severity="success"
            title="Guardar" (click)="guardarTurno(turno, ri)"></p-button>
          <p-button *ngIf="editing" icon="pi pi-times" [text]="true" [raised]="true" severity="danger"
            title="Cancelar" (click)="cancelarEdicion(turno, ri)"></p-button>
          <p-button icon="pi pi-trash" [text]="true" [raised]="true" severity="danger"
            title="Eliminar" (click)="confirmarEliminar(turno.id!)"></p-button>
        </td>

      </tr>
    </ng-template>
  </p-table>
</div>
